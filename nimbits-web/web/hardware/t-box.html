<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Nimbits T-BOX 1.0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <script type="text/javascript" src="/assets/js/jquery/jquery-1.7.1.js"></script>
    <!-- Le styles -->
    <link href="/assets/bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }
    </style>
    <script src="/assets/js/util.js"></script>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" >
        var local;

        function submitData() {
            var obj = {
                email :document.getElementById("email").value,
                instance: document.getElementById("url").value,
                key:  document.getElementById("key").value,
                tpoint:  document.getElementById("tpoint").value,
                hpoint:  document.getElementById("hpoint").value
            }
            var j = JSON.stringify(obj);
            var d = "?data=|" + j + "|";

            window.location = "http://" + local + d;
        }

        function loadForm() {
            local = getParameterByName("local");
            document.getElementById("local").innerText =" " + local + " ";
            var settings = getParameterByName("settings");

            if (settings != null && settings.length > 10)
            {
                //the arduino is losing out , for some reason...
                settings = settings.split("\"\"").join("\",\"");


                var obj = JSON.parse(settings);

                if (obj.instance != undefined && obj.instance.length > 0)
                {
                    document.getElementById("url").value = obj.instance;

                }
                else {
                    document.getElementById("url").value = "nimbits1.appspot.com";
                }
                if (obj.email != undefined) {document.getElementById("email").value = obj.email;}
                if (obj.key != undefined) {document.getElementById("key").value = obj.key;}
                if (obj.tpoint != undefined) { document.getElementById("tpoint").value = obj.tpoint; }
                if (obj.hpoint != undefined) { document.getElementById("hpoint").value = obj.hpoint; }

            }

        }
    </script>

</head>

<body onload="loadForm();">



<div class="container">

    <!-- Main hero unit for a primary marketing message or call to action -->
    <div class="hero-unit">
        <h1>Nimbits T-BOX 1.0</h1>
        <p>This device will log the temperature to your Nimbits Cloud.</p>
        <p><a href="http://www.nimbits.com" class="btn btn-primary btn-large">nimbits.com &raquo;</a></p>
    </div>
    <p>Your device is on your local network using IP Address: <span class="btn-info" id="local"></span></p>
    <h5>Configuration</h5>
    <div class="row">
        <div class="span6">

            <form class="well">
                <label>Nimbits Instance URL:</label>
                <input type="text" id="url" class="span3" value="nimbits1.appspot.com">
                <input type="text" id="email" class="span3" placeholder="Email Address">
                <input type="text" id="key" class="span3" placeholder="Read Write Key">
                <input type="text" id="tpoint" class="span3" placeholder="Temperature Point">
                <input type="text" id="hpoint" class="span3" placeholder="Humidity Point">

                <button type="button" style="float:right" class="btn btn-primary" onclick="submitData();">Save Changes</button>
            </form>
        </div>
    </div>

    <hr>

    <footer>
        <div><p style="text-align: center; font-size: x-small; color: #aaaaaa;">&copy; copyright 2011 Tonic Solutions LLC - all
            rights reserved.</p></div>
    </footer>

</div> <!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->


<script src="/assets/bootstrap/js/bootstrap-button.js"></script>


</body>
</html>
